@page
@model Barangay.Pages.Nurse.EditHEEADSSSAssessmentModel
@{
    ViewData["Title"] = "Edit HEEADSSS Assessment";
    Layout = "~/Pages/Shared/_NurseLayout.cshtml";
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="m-0">
            <i class="fas fa-edit text-primary me-2"></i>
            Edit HEEADSSS Assessment
        </h2>
        <a href="/Nurse/AppointmentDetails?id=@Model.Assessment.AppointmentId" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-1"></i>
            Back to Appointment
        </a>
    </div>

    @if (!string.IsNullOrEmpty(TempData["StatusMessage"]?.ToString()))
    {
        <div class="alert @(TempData["StatusMessage"].ToString().Contains("Error") ? "alert-danger" : "alert-success") alert-dismissible fade show" role="alert">
            @TempData["StatusMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <form method="post" id="heeadsssAssessmentForm">
        @Html.AntiForgeryToken()
        <input asp-for="Assessment.AppointmentId" type="hidden" />
        <input asp-for="Assessment.UserId" type="hidden" />

        <!-- Patient Information -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-user me-2"></i>
                            Patient Information
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="Assessment.FullName" class="form-label">Full Name</label>
                                    <input asp-for="Assessment.FullName" class="form-control" readonly />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label asp-for="Assessment.Age" class="form-label">Age</label>
                                    <input asp-for="Assessment.Age" class="form-control" readonly />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label asp-for="Assessment.Birthday" class="form-label">Birthday</label>
                                    <input asp-for="Assessment.Birthday" type="date" class="form-control" readonly />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="Assessment.HealthFacility" class="form-label">Health Facility</label>
                                    <input asp-for="Assessment.HealthFacility" class="form-control" readonly />
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="Assessment.FamilyNo" class="form-label">Family No</label>
                                    <input asp-for="Assessment.FamilyNo" class="form-control" readonly />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- HOME Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0">HOME</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="Assessment.HomeFamilyProblems" class="form-label">Meron bang problema sa inyong pamilya na kung saan ikaw ay maaaring maapektuhan?</label>
                            <textarea asp-for="Assessment.HomeFamilyProblems" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.HomeParentalListening" class="form-label">Pinakikinggan ka ba ng iyong magulang o guardian sa tuwing ikaw ay may problema?</label>
                            <textarea asp-for="Assessment.HomeParentalListening" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.HomeParentalBlame" class="form-label">May pagkakataon bang nasisi iyong magulang?</label>
                            <textarea asp-for="Assessment.HomeParentalBlame" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.HomeFamilyChanges" class="form-label">Sa nakaraang taon, meron bang pagbabagong naganap sa loob ng iyong pamilya?</label>
                            <textarea asp-for="Assessment.HomeFamilyChanges" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- EDUCATION Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">EDUCATION</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="Assessment.EducationCurrentlyStudying" class="form-label">Ikaw ba ay kasalukuyang nag-aaral?</label>
                            <textarea asp-for="Assessment.EducationCurrentlyStudying" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.EducationWorking" class="form-label">Ikaw ba ay nagtatrabaho? Kung oo, ano ang iyong trabaho?</label>
                            <textarea asp-for="Assessment.EducationWorking" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.EducationSchoolWorkProblems" class="form-label">May problema ka ba sa iskwela o sa trabaho?</label>
                            <textarea asp-for="Assessment.EducationSchoolWorkProblems" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- EATING Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0">EATING</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="Assessment.EatingBodyImageSatisfaction" class="form-label">Kuntento ka ba sa iyong itsura, anyo, o sa iyong kasalukuyang timbang?</label>
                            <textarea asp-for="Assessment.EatingBodyImageSatisfaction" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.EatingDisorderedEatingBehaviors" class="form-label">Sinubukan mo na bang magbawas ng timbang sa pamamagitan ng pagsuka ng kinain (vomiting), uminom ng diet pills o pampadumi (laxatives), o kaya ang sadyang hindi pagkain (starvation)?</label>
                            <textarea asp-for="Assessment.EatingDisorderedEatingBehaviors" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVITIES Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="mb-0">ACTIVITIES</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="Assessment.ActivitiesParticipation" class="form-label">Mayroon ka bang mga sinasalihang sports/ aktibidad sa iskwela, trabaho o bahay?</label>
                            <textarea asp-for="Assessment.ActivitiesParticipation" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.ActivitiesRegularExercise" class="form-label">Regular ka bang nag-eehersisyo?</label>
                            <textarea asp-for="Assessment.ActivitiesRegularExercise" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- DRUGS Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-danger text-white">
                        <h5 class="mb-0">DRUGS</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="Assessment.DrugsTobaccoUse" class="form-label">Naranasan mo na bang gumamit ng mga sumusunod: Tobacco (Sigarilyo)?</label>
                            <textarea asp-for="Assessment.DrugsTobaccoUse" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.DrugsAlcoholUse" class="form-label">Naranasan mo na bang gumamit ng mga sumusunod: Alcohol (Alak)?</label>
                            <textarea asp-for="Assessment.DrugsAlcoholUse" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SEXUALITY Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-dark text-white">
                        <h5 class="mb-0">SEXUALITY</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="Assessment.SexualityIntimateRelationships" class="form-label">Ikaw ba ay may karanasan na sa pakikipagtalik?</label>
                            <textarea asp-for="Assessment.SexualityIntimateRelationships" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.SexualityProtection" class="form-label">May ginagamit ka bang proteksiyon kapag sa tuwing nakikipagtalik?</label>
                            <textarea asp-for="Assessment.SexualityProtection" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SAFETY Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">SAFETY</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="Assessment.SafetyPhysicalAbuse" class="form-label">Ikaw ba ay nakakaranas mahipuan/masuntok/masampal/matulak ng kahit sino?</label>
                            <textarea asp-for="Assessment.SafetyPhysicalAbuse" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.SafetyRelationshipViolence" class="form-label">Nakaranas ka na bang masaktan o takutin ng iyong karelasyon?</label>
                            <textarea asp-for="Assessment.SafetyRelationshipViolence" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SUICIDE Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-danger text-white">
                        <h5 class="mb-0">SUICIDE</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="Assessment.SuicideDepressionFeelings" class="form-label">Ikaw ba ay nakakaranas na ng pagkalisa o pagkamalungkutin?</label>
                            <textarea asp-for="Assessment.SuicideDepressionFeelings" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.SuicideSelfHarmThoughts" class="form-label">Naisip mo na bang saktan ang iyong sarili o wakasan ang iyong buhay?</label>
                            <textarea asp-for="Assessment.SuicideSelfHarmThoughts" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Assessment Information -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">Assessment Information</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="Assessment.AssessedBy" class="form-label">Assessed By</label>
                            <input asp-for="Assessment.AssessedBy" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label asp-for="Assessment.Notes" class="form-label">Notes</label>
                            <textarea asp-for="Assessment.Notes" class="form-control" rows="4"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="row mt-4">
            <div class="col-12 text-center">
                <button type="button" class="btn btn-success btn-lg me-3" onclick="printAssessment()">
                    <i class="fas fa-print me-2"></i>
                    Print Assessment
                </button>
                <button type="submit" class="btn btn-primary btn-lg">
                    <i class="fas fa-save me-2"></i>
                    Update Assessment
                </button>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    <!-- SweetAlert2 for notifications -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        // Print Assessment Function
        function printAssessment() {
            // Create a new window for printing
            const printWindow = window.open('', '_blank');
            
            // Get the current form data
            const patientName = document.querySelector('input[name="Assessment.FullName"]').value;
            const age = document.querySelector('input[name="Assessment.Age"]').value;
            const birthday = document.querySelector('input[name="Assessment.Birthday"]').value;
            const healthFacility = document.querySelector('input[name="Assessment.HealthFacility"]').value;
            const familyNo = document.querySelector('input[name="Assessment.FamilyNo"]').value;
            const assessedBy = document.querySelector('input[name="Assessment.AssessedBy"]').value;
            
            // Get all textarea values
            const homeFamilyProblems = document.querySelector('textarea[name="Assessment.HomeFamilyProblems"]').value;
            const homeParentalListening = document.querySelector('textarea[name="Assessment.HomeParentalListening"]').value;
            const homeParentalBlame = document.querySelector('textarea[name="Assessment.HomeParentalBlame"]').value;
            const homeFamilyChanges = document.querySelector('textarea[name="Assessment.HomeFamilyChanges"]').value;
            
            const educationCurrentlyStudying = document.querySelector('textarea[name="Assessment.EducationCurrentlyStudying"]').value;
            const educationWorking = document.querySelector('textarea[name="Assessment.EducationWorking"]').value;
            const educationSchoolWorkProblems = document.querySelector('textarea[name="Assessment.EducationSchoolWorkProblems"]').value;
            
            const eatingBodyImageSatisfaction = document.querySelector('textarea[name="Assessment.EatingBodyImageSatisfaction"]').value;
            const eatingDisorderedEatingBehaviors = document.querySelector('textarea[name="Assessment.EatingDisorderedEatingBehaviors"]').value;
            
            const activitiesParticipation = document.querySelector('textarea[name="Assessment.ActivitiesParticipation"]').value;
            const activitiesRegularExercise = document.querySelector('textarea[name="Assessment.ActivitiesRegularExercise"]').value;
            
            const drugsTobaccoUse = document.querySelector('textarea[name="Assessment.DrugsTobaccoUse"]').value;
            const drugsAlcoholUse = document.querySelector('textarea[name="Assessment.DrugsAlcoholUse"]').value;
            
            const sexualityIntimateRelationships = document.querySelector('textarea[name="Assessment.SexualityIntimateRelationships"]').value;
            const sexualityProtection = document.querySelector('textarea[name="Assessment.SexualityProtection"]').value;
            
            const safetyPhysicalAbuse = document.querySelector('textarea[name="Assessment.SafetyPhysicalAbuse"]').value;
            const safetyRelationshipViolence = document.querySelector('textarea[name="Assessment.SafetyRelationshipViolence"]').value;
            
            const suicideDepressionFeelings = document.querySelector('textarea[name="Assessment.SuicideDepressionFeelings"]').value;
            const suicideSelfHarmThoughts = document.querySelector('textarea[name="Assessment.SuicideSelfHarmThoughts"]').value;
            
            const notes = document.querySelector('textarea[name="Assessment.Notes"]').value;
            
            // Create HTML content for printing
            const printContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>HEEADSSS Assessment - ${patientName}</title>
                    <style>
                        body { 
                            font-family: Arial, sans-serif; 
                            margin: 0; 
                            padding: 20px; 
                            font-size: 12px;
                            line-height: 1.4;
                        }
                        .form-container {
                            max-width: 8.5in;
                            margin: 0 auto;
                            background: white;
                        }
                        .header {
                            text-align: center;
                            margin-bottom: 20px;
                            border-bottom: 2px solid #000;
                            padding-bottom: 10px;
                        }
                        .header h1 {
                            font-size: 16px;
                            font-weight: bold;
                            margin: 0;
                            text-transform: uppercase;
                        }
                        .header h2 {
                            font-size: 14px;
                            margin: 5px 0;
                            font-weight: normal;
                        }
                        .page-info {
                            text-align: right;
                            font-size: 10px;
                            margin-bottom: 15px;
                        }
                        .patient-section {
                            margin-bottom: 20px;
                        }
                        .section-title {
                            font-weight: bold;
                            font-size: 13px;
                            margin: 15px 0 10px 0;
                            text-decoration: underline;
                        }
                        .question-table {
                            width: 100%;
                            border-collapse: collapse;
                            margin-bottom: 15px;
                        }
                        .question-table td {
                            padding: 8px;
                            vertical-align: top;
                            border: 1px solid #000;
                        }
                        .question-text {
                            width: 70%;
                            font-size: 11px;
                        }
                        .response-cell {
                            width: 30%;
                            text-align: center;
                            font-weight: bold;
                        }
                        .hope-section {
                            margin-top: 30px;
                            text-align: center;
                            border: 2px solid #000;
                            padding: 15px;
                        }
                        .hope-title {
                            font-weight: bold;
                            font-size: 14px;
                            margin-bottom: 5px;
                        }
                        .hope-subtitle {
                            font-size: 12px;
                            margin-bottom: 10px;
                        }
                        .hope-numbers {
                            font-size: 13px;
                            font-weight: bold;
                        }
                        .notes-section {
                            margin-top: 20px;
                        }
                        .notes-title {
                            font-weight: bold;
                            margin-bottom: 5px;
                        }
                        .notes-lines {
                            border-bottom: 1px solid #000;
                            height: 20px;
                            margin-bottom: 10px;
                        }
                        .disclaimer {
                            margin-top: 20px;
                            font-size: 10px;
                            text-align: center;
                        }
                        @@media print { 
                            body { margin: 0; padding: 15px; }
                            .form-container { max-width: none; }
                        }
                    </style>
                </head>
                <body>
                    <div class="form-container">
                        <div class="page-info">
                            Page 1 of 2
                        </div>
                        
                        <div class="header">
                            <h1>HEEADSSS HEALTH ASSESSMENT FORM</h1>
                            <h2>(For 10-19 years old)</h2>
                        </div>
                    
                        <div class="patient-section">
                            <div class="section-title">A. PERSONAL INFORMATION</div>
                            <table class="question-table">
                                <tr>
                                    <td style="width: 20%;"><strong>Name:</strong></td>
                                    <td style="width: 80%;">${patientName}</td>
                                </tr>
                                <tr>
                                    <td><strong>Age:</strong></td>
                                    <td>${age} years old</td>
                                </tr>
                                <tr>
                                    <td><strong>Birthday:</strong></td>
                                    <td>${birthday}</td>
                                </tr>
                                <tr>
                                    <td><strong>Health Facility:</strong></td>
                                    <td>${healthFacility}</td>
                                </tr>
                                <tr>
                                    <td><strong>Family No:</strong></td>
                                    <td>${familyNo}</td>
                                </tr>
                                <tr>
                                    <td><strong>Assessment Date:</strong></td>
                                    <td>${new Date().toLocaleDateString()}</td>
                                </tr>
                                <tr>
                                    <td><strong>Assessed By:</strong></td>
                                    <td>${assessedBy || '_________________'}</td>
                                </tr>
                            </table>
                        </div>
                    
                        <div class="section-title">C. PSYCHOSOCIAL HISTORY AND ASSESSMENT</div>
                        <p style="font-size: 11px; margin-bottom: 15px;">
                            <em>Ang matapat mong kasagutan ay makakatulong sa amin upang ikaw ay mabigyan ng tamang pangangalaga. Itanong lamang sa amin kung may mga katanungan.</em>
                        </p>
                        
                        <div class="section-title">HOME</div>
                        <table class="question-table">
                            <tr>
                                <td class="question-text">Meron bang problema sa inyong pamilya na kung saan ikaw ay maaaring maapektuhan?</td>
                                <td class="response-cell">${homeFamilyProblems || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Pinakikinggan ka ba ng iyong magulang o guardian sa tuwing ikaw ay may problema?</td>
                                <td class="response-cell">${homeParentalListening || 'Yes'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">May pagkakataon bang nasisi iyong magulang?</td>
                                <td class="response-cell">${homeParentalBlame || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Sa nakaraang taon, meron bang pagbabagong naganap sa loob ng iyong pamilya?</td>
                                <td class="response-cell">${homeFamilyChanges || 'No'}</td>
                            </tr>
                        </table>
                    
                        <div class="section-title">EDUCATION</div>
                        <table class="question-table">
                            <tr>
                                <td class="question-text">Ikaw ba ay kasalukuyang nag-aaral?</td>
                                <td class="response-cell">${educationCurrentlyStudying || 'Yes'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Ikaw ba ay nagtatrabaho? Kung oo, ano ang iyong trabaho?</td>
                                <td class="response-cell">${educationWorking || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">May problema ka ba sa iskwela o sa trabaho?</td>
                                <td class="response-cell">${educationSchoolWorkProblems || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Nakaranas ka bang ma-api (bully) sa iskwela o sa iba pang pagkakataon?</td>
                                <td class="response-cell">No</td>
                            </tr>
                        </table>
                    
                        <div class="section-title">EATING HABITS</div>
                        <table class="question-table">
                            <tr>
                                <td class="question-text">Kuntento ka ba sa iyong itsura, anyo, o sa iyong kasalukuyang timbang?</td>
                                <td class="response-cell">${eatingBodyImageSatisfaction || 'Yes'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Sinubukan mo na bang magbawas ng timbang sa pamamagitan ng pagsuka ng kinain (vomiting), uminom ng diet pills o pampadumi (laxatives), o kaya ang sadyang hindi pagkain (starvation)?</td>
                                <td class="response-cell">${eatingDisorderedEatingBehaviors || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">May nagpuna na ba na ikaw ay tumataba o pumapayat?</td>
                                <td class="response-cell">No</td>
                            </tr>
                        </table>
                        
                        <div class="section-title">ACTIVITIES</div>
                        <table class="question-table">
                            <tr>
                                <td class="question-text">Mayroon ka bang mga sinasalihang sports/aktibidad sa iskwela, trabaho o bahay?</td>
                                <td class="response-cell">${activitiesParticipation || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Regular ka bang nag-ehersisyo?</td>
                                <td class="response-cell">${activitiesRegularExercise || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Madalas ka bang gumamit ng mga gadgets/internet/computer?</td>
                                <td class="response-cell">Yes</td>
                            </tr>
                        </table>
                        
                        <div class="section-title">DRUGS</div>
                        <p style="font-size: 11px; margin-bottom: 10px;"><strong>Naranasan mo na bang gumamit ng mga sumusunod:</strong></p>
                        <table class="question-table">
                            <tr>
                                <td class="question-text">Tobacco (Sigarilyo)?</td>
                                <td class="response-cell">${drugsTobaccoUse || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Alcohol (Alak)?</td>
                                <td class="response-cell">${drugsAlcoholUse || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Street drugs/prohibited drugs?</td>
                                <td class="response-cell">No</td>
                            </tr>
                        </table>
                        
                        <div class="section-title">SEXUALITY</div>
                        <table class="question-table">
                            <tr>
                                <td class="question-text">Nababahala ka ba sa iyong kalusugan o mga pagbabago ng iyong pangangatawan?</td>
                                <td class="response-cell">No</td>
                            </tr>
                            <tr>
                                <td class="question-text">Ikaw ba ay may karanasan na sa pakikipagtalik?</td>
                                <td class="response-cell">${sexualityIntimateRelationships || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Kung oo, ilan na ang taong nakatalik mo sa nakaraang taon?</td>
                                <td class="response-cell">No</td>
                            </tr>
                            <tr>
                                <td class="question-text">Iniisip mo ba na ikaw ay gay, lesbian, o bisexual?</td>
                                <td class="response-cell">No</td>
                            </tr>
                            <tr>
                                <td class="question-text">Ikaw ba ay nakaranas nang magbuntis o makabuntis?</td>
                                <td class="response-cell">No</td>
                            </tr>
                            <tr>
                                <td class="question-text">Ikaw ba ay nagkaroon na ng nakakahawang sakit dulot ng pakikipagtalik?</td>
                                <td class="response-cell">No</td>
                            </tr>
                            <tr>
                                <td class="question-text">May ginagamit ka bang proteksyon kapag sa tuwing nakikipagtalik?</td>
                                <td class="response-cell">${sexualityProtection || 'No'}</td>
                            </tr>
                        </table>
                        
                        <div class="section-title">SAFETY/WEAPONS/VIOLENCE</div>
                        <table class="question-table">
                            <tr>
                                <td class="question-text">Ikaw ba ay nakaranas mahipuan/masuntok/masampal/matulak ng kahit na sino?</td>
                                <td class="response-cell">${safetyPhysicalAbuse || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Nakaranas ka na bang masaktan o takutin ng iyong karelasyon?</td>
                                <td class="response-cell">${safetyRelationshipViolence || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Gumagamit ka ba ng helmet o protective gears sa pagsakay ng motor o iba pang uri ng sasakyan?</td>
                                <td class="response-cell">No</td>
                            </tr>
                            <tr>
                                <td class="question-text">May kasambahay ka bang nagmamay-ari ng baril o rifle?</td>
                                <td class="response-cell">No</td>
                            </tr>
                        </table>
                        
                        <div class="section-title">SUICIDE/DEPRESSION</div>
                        <table class="question-table">
                            <tr>
                                <td class="question-text">Ikaw ba ay nakakaranas na ng pagkabalisa o pagkamalungkutin?</td>
                                <td class="response-cell">${suicideDepressionFeelings || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">Naisip mo na bang saktan ang iyong sarili o wakasan ang iyong buhay?</td>
                                <td class="response-cell">${suicideSelfHarmThoughts || 'No'}</td>
                            </tr>
                            <tr>
                                <td class="question-text">May miyembro ka ba ng pamilya na nagtangkang magpakamatay o nakaranas ng matinding kalungkutan o labis na pagkabalisa?</td>
                                <td class="response-cell">No</td>
                            </tr>
                        </table>
                        
                        <div class="hope-section">
                            <div class="hope-title">HOPE line</div>
                            <div class="hope-subtitle">for suicide prevention and emotional crisis</div>
                            <div class="hope-numbers">804-4673 (HOPE)/ 0917-558-4673 (HOPE)</div>
                        </div>
                        
                        <div class="notes-section">
                            <div class="notes-title">Notes:</div>
                            <div class="notes-lines"></div>
                            <div class="notes-lines"></div>
                            <div class="notes-lines"></div>
                            <div class="notes-lines"></div>
                            <div class="notes-lines"></div>
                        </div>
                        
                        <div class="disclaimer">
                            <strong>***Ang HEEADSSS Psychosocial History and Assessment ay naglalaman ng ilang katanungan para sa kabataan. Ang health provider ay maari pang magdagdag ng wastong katanungan kung kinakailangan.</strong>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            // Write content to print window
            printWindow.document.write(printContent);
            printWindow.document.close();
            
            // Wait for content to load, then print
            printWindow.onload = function() {
                printWindow.print();
                printWindow.close();
            };
        }
        
        $(document).ready(function() {
            // Form submission
            $('#heeadsssAssessmentForm').on('submit', function(e) {
                e.preventDefault();
                
                // Show loading
                Swal.fire({
                    title: 'Updating...',
                    text: 'Please wait while we update the assessment.',
                    allowOutsideClick: false,
                    showConfirmButton: false,
                    willOpen: () => {
                        Swal.showLoading();
                    }
                });
                
                // Submit form
                $.ajax({
                    url: window.location.pathname,
                    type: 'POST',
                    data: $(this).serialize(),
                    success: function(response) {
                        Swal.fire({
                            title: 'Success!',
                            text: 'The HEEADSSS assessment has been updated successfully.',
                            icon: 'success',
                            confirmButtonText: 'OK'
                        }).then(() => {
                            window.location.href = '/Nurse/AppointmentDetails?id=@Model.Assessment.AppointmentId';
                        });
                    },
                    error: function(xhr) {
                        Swal.fire({
                            title: 'Error',
                            text: 'An error occurred while updating the assessment. Please try again.',
                            icon: 'error',
                            confirmButtonText: 'OK'
                        });
                    }
                });
            });
        });
    </script>
}
